import os
import platform

from platformdirs import user_cache_dir, user_config_dir, user_data_dir

from web3_exploit_framework.base import AUTHOR, NAME

operating_system = platform.system()


def append_app_name(path):
    return os.path.join(path, NAME)


def append_setting_yaml(path):
    return os.path.join(path, "setting.yaml")


"""Configuration Folder"""


def get_config_folder_path():
    if operating_system == "Darwin":
        return append_app_name(os.path.expanduser("~/.config"))
    else:
        return user_config_dir(NAME, AUTHOR)


"""Data Folder"""


def get_data_folder_path():
    if operating_system == "Darwin":
        return append_app_name(os.path.expanduser("~/.local/share"))
    else:
        return user_data_dir(NAME, AUTHOR)


def get_default_exploits_folder():
    return os.path.join(get_data_folder_path(), "exploits")


def get_default_interfaces_folder():
    return os.path.join(get_data_folder_path(), "interfaces")


def get_default_tokens_folder():
    return os.path.join(get_data_folder_path(), "tokens")


"""Database"""


def get_original_interfaces_path():
    current_directory = os.path.dirname(os.path.abspath(__file__))
    path_to_interfaces_folder = os.path.join(
        current_directory, "..", "..", "db", "interfaces"
    )
    return path_to_interfaces_folder


def get_original_tokens_path():
    current_directory = os.path.dirname(os.path.abspath(__file__))
    path_to_tokens_folder = os.path.join(
        current_directory, "..", "..", "db", "tokens"
    )
    return path_to_tokens_folder


def get_original_exploits_path():
    current_directory = os.path.dirname(os.path.abspath(__file__))
    path_to_exploits_folder = os.path.join(
        current_directory, "..", "..", "modules", "exploits"
    )
    return path_to_exploits_folder


"""Cache Folder"""


def get_cache_folder_path():
    if operating_system == "Darwin":
        return append_app_name(os.path.expanduser("~/.cache"))
    else:
        return user_cache_dir(NAME, AUTHOR)


"""Setting Yaml"""


def get_setting_yaml_path():
    return append_setting_yaml(get_config_folder_path())


"""Module"""


def get_module_cache_path():
    return os.path.join(get_cache_folder_path(), "modules")


"""Development Framework"""


def get_development_framework_path(framework_name):
    return os.path.join(get_data_folder_path(), "framework", framework_name)


def get_development_framework_configuration_path(framework_name):
    current_directory = os.path.dirname(os.path.abspath(__file__))
    path_to_resources_folder = os.path.join(
        current_directory, "..", "..", "development_framework_configuration"
    )
    return os.path.join(path_to_resources_folder, framework_name)


# def get_directory(path):
#     try:
#         return os.path.dirname(os.path.abspath(path))
#     except Exception as e:
#         raise Get_Directory_Error
