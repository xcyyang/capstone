from web3_exploit_framework.base import NAME, AUTHOR
from web3_exploit_framework.core.exceptions import Setting_Yaml_Create_Error, Setting_Yaml_Read_Error, Setting_Yaml_Save_Error
from web3_exploit_framework.core.platform_dirs import get_config_folder_path, get_setting_yaml_path
from web3_exploit_framework.core.setting_sample import get_sample_for_setting_yaml_file 
from web3_exploit_framework.core.utils.file import create_folder, read_yaml_file, dump_yaml_file_to, save_setting_file
from web3_exploit_framework.core.config import settings
import yaml

class Framework:
    def __init__(self) -> None:
        try:
            self.check_setting_yaml_file()
        except(Setting_Yaml_Read_Error):
            self.create_setting_yaml_file()
        
        self.settings = settings


    def check_setting_yaml_file(self):
        try:
            read_yaml_file(get_setting_yaml_path())
        except(FileNotFoundError):
            raise Setting_Yaml_Read_Error

    def create_setting_yaml_file(self):
        try:
            sample = get_sample_for_setting_yaml_file()
            create_folder(get_config_folder_path())
            dump_yaml_file_to(sample, get_setting_yaml_path())
        except(Exception):
            raise Setting_Yaml_Create_Error
    
    def save_setting_yaml_file(self):
        try:
            save_setting_file(self.settings._wrapped.as_dict(), get_setting_yaml_path())  
        except(Exception):
            raise Setting_Yaml_Save_Error

